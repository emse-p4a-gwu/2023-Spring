<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Frames</title>
    <meta charset="utf-8" />
    <meta name="author" content="John Paul Helveston" />
    <meta name="date" content="2023-03-30" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <meta name="description" content="EMSE 4571: Intro to Programming for Analytics"/>
    <meta name="generator" content="xaringan and remark.js"/>
    <meta name="github-repo" content="emse-p4a-gwu/2023-Spring"/>
    <meta name="twitter:title" content="Data Frames"/>
    <meta name="twitter:description" content="EMSE 4571: Intro to Programming for Analytics"/>
    <meta name="twitter:url" content="https://p4a.seas.gwu.edu/2023-Spring/"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:creator" content="@johnhelveston"/>
    <meta name="twitter:site" content="@johnhelveston"/>
    <meta property="og:title" content="Data Frames"/>
    <meta property="og:description" content="EMSE 4571: Intro to Programming for Analytics"/>
    <meta property="og:url" content="https://p4a.seas.gwu.edu/2023-Spring/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="John Paul Helveston"/>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="css/lexis.css" type="text/css" />
    <link rel="stylesheet" href="css/lexis-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">





class: middle, inverse

.leftcol30[

&lt;center&gt;
&lt;img src="https://github.com/emse-p4a-gwu/emse-p4a-gwu.github.io/raw/master/images/p4a_hex_sticker.png" width=250&gt;
&lt;/center&gt;

]

.rightcol70[

# Week 10: .fancy[Data Frames]

### <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M243.4 2.6l-224 96c-14 6-21.8 21-18.7 35.8S16.8 160 32 160v8c0 13.3 10.7 24 24 24H456c13.3 0 24-10.7 24-24v-8c15.2 0 28.3-10.7 31.3-25.6s-4.8-29.9-18.7-35.8l-224-96c-8.1-3.4-17.2-3.4-25.2 0zM128 224H64V420.3c-.6 .3-1.2 .7-1.8 1.1l-48 32c-11.7 7.8-17 22.4-12.9 35.9S17.9 512 32 512H480c14.1 0 26.5-9.2 30.6-22.7s-1.1-28.1-12.9-35.9l-48-32c-.6-.4-1.2-.7-1.8-1.1V224H384V416H344V224H280V416H232V224H168V416H128V224zm128-96c-17.7 0-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32s-14.3 32-32 32z"/></svg> EMSE 4571: Intro to Programming for Analytics
### <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M272 304h-96C78.8 304 0 382.8 0 480c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32C448 382.8 369.2 304 272 304zM48.99 464C56.89 400.9 110.8 352 176 352h96c65.16 0 119.1 48.95 127 112H48.99zM224 256c70.69 0 128-57.31 128-128c0-70.69-57.31-128-128-128S96 57.31 96 128C96 198.7 153.3 256 224 256zM224 48c44.11 0 80 35.89 80 80c0 44.11-35.89 80-80 80S144 172.1 144 128C144 83.89 179.9 48 224 48z"/></svg> John Paul Helveston
### <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M152 64H296V24C296 10.75 306.7 0 320 0C333.3 0 344 10.75 344 24V64H384C419.3 64 448 92.65 448 128V448C448 483.3 419.3 512 384 512H64C28.65 512 0 483.3 0 448V128C0 92.65 28.65 64 64 64H104V24C104 10.75 114.7 0 128 0C141.3 0 152 10.75 152 24V64zM48 448C48 456.8 55.16 464 64 464H384C392.8 464 400 456.8 400 448V192H48V448z"/></svg> March 30, 2023

]



---

# Before we start

Make sure you have these packages installed and loaded:


```r
install.packages("stringr")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("readr")
install.packages("here")
```

(At the top of the `practice.R` file)

Remember: you only need to install them once!

---

.leftcol[

## "The purpose of computing is _insight_, not numbers"
### - [Richard Hamming](https://en.wikipedia.org/wiki/Richard_Hamming)

]

.rightcol[

&lt;img src="images/Richard_Hamming.jpg" width="400"&gt;

]

---



class: inverse, middle

# Week 10: .fancy[Data Frames]

### 1. Basics
### 2. Slicing

### BREAK

### 3. External data

---



class: inverse, middle

# Week 10: .fancy[Data Frames]

### 1. .orange[Basics]
### 2. Slicing

### BREAK

### 3. External data

---

class: center

# The data frame...in Excel

&lt;center&gt;
&lt;img src="images/spreadsheet.png" width=700&gt;
&lt;/center&gt;

---

# The data frame...in R


```r
beatles &lt;- tibble(
    firstName   = c("John", "Paul", "Ringo", "George"),
    lastName    = c("Lennon", "McCartney", "Starr", "Harrison"),
    instrument  = c("guitar", "bass", "drums", "guitar"),
    yearOfBirth = c(1940, 1942, 1940, 1943),
    deceased    = c(TRUE, FALSE, FALSE, TRUE)
)

beatles
```

```
#&gt; # A tibble: 4 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE   
#&gt; 3 Ringo     Starr     drums             1940 FALSE   
#&gt; 4 George    Harrison  guitar            1943 TRUE
```

---

# The data frame...in RStudio

.leftcol[


```r
View(beatles)
```

]

&lt;img src="images/dataframe.png" width="700"&gt;

---

## **Columns**: _Vectors_ of values (must be same data type)


```r
beatles
```

```
#&gt; # A tibble: 4 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE   
#&gt; 3 Ringo     Starr     drums             1940 FALSE   
#&gt; 4 George    Harrison  guitar            1943 TRUE
```

--

Extract a column using `$`


```r
beatles$firstName
```

```
#&gt; [1] "John"   "Paul"   "Ringo"  "George"
```

---

## **Rows**: Information about individual observations

--

Information about _John Lennon_ is in the first row:


```r
beatles[1,]
```

```
#&gt; # A tibble: 1 × 5
#&gt;   firstName lastName instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon   guitar            1940 TRUE
```

--

Information about _Paul McCartney_ is in the second row:


```r
beatles[2,]
```

```
#&gt; # A tibble: 1 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 Paul      McCartney bass              1942 FALSE
```

---

## Make a data frame with `data.frame()`


```r
beatles &lt;- data.frame(
    firstName   = c("John", "Paul", "Ringo", "George"),
    lastName    = c("Lennon", "McCartney", "Starr", "Harrison"),
    instrument  = c("guitar", "bass", "drums", "guitar"),
    yearOfBirth = c(1940, 1942, 1940, 1943),
    deceased    = c(TRUE, FALSE, FALSE, TRUE)
)
```

--


```r
beatles
```

```
#&gt;   firstName  lastName instrument yearOfBirth deceased
#&gt; 1      John    Lennon     guitar        1940     TRUE
#&gt; 2      Paul McCartney       bass        1942    FALSE
#&gt; 3     Ringo     Starr      drums        1940    FALSE
#&gt; 4    George  Harrison     guitar        1943     TRUE
```

---

## Make a data frame with `tibble()`


```r
library(dplyr)
```


```r
beatles &lt;- tibble(
    firstName   = c("John", "Paul", "Ringo", "George"),
    lastName    = c("Lennon", "McCartney", "Starr", "Harrison"),
    instrument  = c("guitar", "bass", "drums", "guitar"),
    yearOfBirth = c(1940, 1942, 1940, 1943),
    deceased    = c(TRUE, FALSE, FALSE, TRUE)
)
```

--


```r
beatles
```

```
#&gt; # A tibble: 4 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE   
#&gt; 3 Ringo     Starr     drums             1940 FALSE   
#&gt; 4 George    Harrison  guitar            1943 TRUE
```

---

## Why I use `tibble()` instead of `data.frame()`

--

1. The `tibble()` shows the **dimensions** and **data type**.

--

2. A tibble will only print the first few rows of data when you enter the object name
Example: `faithful` vs. `as_tibble(faithful)`

--

3. Columns of class `character` are _never_ converted into factors (don't worry about this for now...just know that tibbles make life easier with strings).

**Note**: I use the word **"data frame"** to refer to both `tibble()` and `data.frame()` objects

---

## Data frame vectors must have the same length


```r
beatles &lt;- tibble(
*   firstName   = c("John", "Paul", "Ringo", "George", "Bob"), # Added "Bob"
    lastName    = c("Lennon", "McCartney", "Starr", "Harrison"),
    instrument  = c("guitar", "bass", "drums", "guitar"),
    yearOfBirth = c(1940, 1942, 1940, 1943),
    deceased    = c(TRUE, FALSE, FALSE, TRUE)
)
```


```
#&gt; Error:
#&gt; ! Tibble columns must have compatible sizes.
#&gt; • Size 5: Existing data.
#&gt; • Size 4: Column `lastName`.
#&gt; ℹ Only values of size one are recycled.
```

---

## Use `NA` for missing values


```r
beatles &lt;- tibble(
    firstName   = c("John", "Paul", "Ringo", "George", "Bob"), 
*   lastName    = c("Lennon", "McCartney", "Starr", "Harrison", NA), # Added NAs
*   instrument  = c("guitar", "bass", "drums", "guitar", NA),
*   yearOfBirth = c(1940, 1942, 1940, 1943, NA),
*   deceased    = c(TRUE, FALSE, FALSE, TRUE, NA)
)
```

--


```r
beatles
```

```
#&gt; # A tibble: 5 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE   
#&gt; 3 Ringo     Starr     drums             1940 FALSE   
#&gt; 4 George    Harrison  guitar            1943 TRUE    
#&gt; 5 Bob       &lt;NA&gt;      &lt;NA&gt;                NA NA
```

---

# Dimensions: `nrow()`, `ncol()`, &amp; `dim()`


```r
nrow(beatles) # Number of rows
```

```
#&gt; [1] 5
```

```r
ncol(beatles) # Number of columns
```

```
#&gt; [1] 5
```

```r
dim(beatles)  # Number of rows and columns
```

```
#&gt; [1] 5 5
```

---

### .center[Use `names()` or `colnames()` to see the available variables]

Get the names of columns:


```r
names(beatles)
```

```
#&gt; [1] "firstName"   "lastName"    "instrument"  "yearOfBirth" "deceased"
```

```r
colnames(beatles)
```

```
#&gt; [1] "firstName"   "lastName"    "instrument"  "yearOfBirth" "deceased"
```

--

Get the names of rows (rarely needed):


```r
rownames(beatles)
```

```
#&gt; [1] "1" "2" "3" "4" "5"
```

---

# Changing the column names

Change the column names with `names()` or `colnames()`:


```r
names(beatles) &lt;- c('one', 'two', 'three', 'four', 'five')
beatles
```


```
#&gt; # A tibble: 5 × 5
#&gt;   one    two       three   four five 
#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;lgl&gt;
#&gt; 1 John   Lennon    guitar  1940 TRUE 
#&gt; 2 Paul   McCartney bass    1942 FALSE
#&gt; 3 Ringo  Starr     drums   1940 FALSE
#&gt; 4 George Harrison  guitar  1943 TRUE 
#&gt; 5 Bob    &lt;NA&gt;      &lt;NA&gt;      NA NA
```

---

# Changing the column names

Make all the column names upper-case:


```r
colnames(beatles) &lt;- stringr::str_to_upper(colnames(beatles))
beatles
```


```
#&gt; # A tibble: 5 × 5
#&gt;   FIRSTNAME LASTNAME  INSTRUMENT YEAROFBIRTH DECEASED
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE   
#&gt; 3 Ringo     Starr     drums             1940 FALSE   
#&gt; 4 George    Harrison  guitar            1943 TRUE    
#&gt; 5 Bob       &lt;NA&gt;      &lt;NA&gt;                NA NA
```

---

## Combine data frames by columns using `bind_cols()`

Note: `bind_cols()` is from the **dplyr** library


```r
names &lt;- tibble(
    firstName = c("John", "Paul", "Ringo", "George"),
    lastName  = c("Lennon", "McCartney", "Starr", "Harrison"))

instruments &lt;- tibble(
    instrument = c("guitar", "bass", "drums", "guitar"))
```

--


```r
bind_cols(names, instruments)
```

```
#&gt; # A tibble: 4 × 3
#&gt;   firstName lastName  instrument
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     
#&gt; 1 John      Lennon    guitar    
#&gt; 2 Paul      McCartney bass      
#&gt; 3 Ringo     Starr     drums     
#&gt; 4 George    Harrison  guitar
```

---

## Combine data frames by rows using `bind_rows()`

Note: `bind_rows()` is from the **dplyr** library


```r
members1 &lt;- tibble(
    firstName = c("John", "Paul"),
    lastName  = c("Lennon", "McCartney"))

members2 &lt;- tibble(
    firstName = c("Ringo", "George"),
    lastName  = c("Starr", "Harrison"))
```

--


```r
bind_rows(members1, members2)
```

```
#&gt; # A tibble: 4 × 2
#&gt;   firstName lastName 
#&gt;   &lt;chr&gt;     &lt;chr&gt;    
#&gt; 1 John      Lennon   
#&gt; 2 Paul      McCartney
#&gt; 3 Ringo     Starr    
#&gt; 4 George    Harrison
```

---

## Note: `bind_rows()` requires the **same** columns names:


```r
*colnames(members2) &lt;- c("firstName", "LastName")
bind_rows(members1, members2)
```

```
#&gt; # A tibble: 4 × 3
#&gt;   firstName lastName  LastName
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   
#&gt; 1 John      Lennon    &lt;NA&gt;    
#&gt; 2 Paul      McCartney &lt;NA&gt;    
#&gt; 3 Ringo     &lt;NA&gt;      Starr   
#&gt; 4 George    &lt;NA&gt;      Harrison
```

Note how `&lt;NA&gt;`s were created

---

class: inverse

<div class="countdown" id="timer_b6960f09" data-warn-when="30" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">06</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

## Your turn

Answer these questions using the `animals_farm` and `animals_pet` data frames:

1. Write code to find how many _rows_ are in the `animals_farm` data frame?
2. Write code to find how many _columns_ are in the `animals_pet` data frame?
3. Create a new data frame, `animals`, by combining `animals_farm` and `animals_pet`.
4. Change the column names of `animals` to title case.
5. Add a new column to `animals` called `type` that tells if an animal is a `"farm"` or `"pet"` animal.

---



class: inverse, middle

# Week 10: .fancy[Data Frames]

### 1. Basics
### 2. .orange[Slicing]

### BREAK

### 3. External data

---

## Access data frame columns using the `$` symbol




```r
beatles$firstName
```

```
#&gt; [1] "John"   "Paul"   "Ringo"  "George"
```

--


```r
beatles$lastName
```

```
#&gt; [1] "Lennon"    "McCartney" "Starr"     "Harrison"
```

---

# Creating new variables with the `$` symbol

--

Add the hometown of the bandmembers:


```r
beatles$hometown &lt;- 'Liverpool'
beatles
```

```
#&gt; # A tibble: 4 × 6
#&gt;   firstName lastName  instrument yearOfBirth deceased hometown 
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;    &lt;chr&gt;    
#&gt; 1 John      Lennon    guitar            1940 TRUE     Liverpool
#&gt; 2 Paul      McCartney bass              1942 FALSE    Liverpool
#&gt; 3 Ringo     Starr     drums             1940 FALSE    Liverpool
#&gt; 4 George    Harrison  guitar            1943 TRUE     Liverpool
```

---

# Creating new variables with the `$` symbol

Add a new `alive` variable:


```r
beatles$alive &lt;- c(FALSE, TRUE, TRUE, FALSE)
beatles
```

```
#&gt; # A tibble: 4 × 7
#&gt;   firstName lastName  instrument yearOfBirth deceased hometown  alive
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;    &lt;chr&gt;     &lt;lgl&gt;
#&gt; 1 John      Lennon    guitar            1940 TRUE     Liverpool FALSE
#&gt; 2 Paul      McCartney bass              1942 FALSE    Liverpool TRUE 
#&gt; 3 Ringo     Starr     drums             1940 FALSE    Liverpool TRUE 
#&gt; 4 George    Harrison  guitar            1943 TRUE     Liverpool FALSE
```

---

## You can compute new variables from current ones

--

Compute and add the age of the bandmembers:


```r
beatles$age &lt;- 2023 - beatles$yearOfBirth
beatles
```

```
#&gt; # A tibble: 4 × 8
#&gt;   firstName lastName  instrument yearOfBirth deceased hometown  alive   age
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;    &lt;chr&gt;     &lt;lgl&gt; &lt;dbl&gt;
#&gt; 1 John      Lennon    guitar            1940 TRUE     Liverpool FALSE    83
#&gt; 2 Paul      McCartney bass              1942 FALSE    Liverpool TRUE     81
#&gt; 3 Ringo     Starr     drums             1940 FALSE    Liverpool TRUE     83
#&gt; 4 George    Harrison  guitar            1943 TRUE     Liverpool FALSE    80
```

---

## Access elements by index: `DF[row, column]`



General form for indexing elements:


```r
DF[row, column]
```

--

.leftcol[

Select the element in row 1, column 2:


```r
beatles[1, 2]
```

```
#&gt; # A tibble: 1 × 1
#&gt;   lastName
#&gt;   &lt;chr&gt;   
#&gt; 1 Lennon
```

]

--

.rightcol[

Select the elements in rows 1 &amp; 2 and columns 2 &amp; 3:


```r
beatles[c(1, 2), c(2, 3)]
```

```
#&gt; # A tibble: 2 × 2
#&gt;   lastName  instrument
#&gt;   &lt;chr&gt;     &lt;chr&gt;     
#&gt; 1 Lennon    guitar    
#&gt; 2 McCartney bass
```

]

---

## Leave row or column "blank" to select all

--


```r
beatles[c(1, 2),] # Selects all COLUMNS for rows 1 &amp; 2
```

```
#&gt; # A tibble: 2 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 John      Lennon    guitar            1940 TRUE    
#&gt; 2 Paul      McCartney bass              1942 FALSE
```

--


```r
beatles[,c(1, 2)] # Selects all ROWS for columns 1 &amp; 2
```

```
#&gt; # A tibble: 4 × 2
#&gt;   firstName lastName 
#&gt;   &lt;chr&gt;     &lt;chr&gt;    
#&gt; 1 John      Lennon   
#&gt; 2 Paul      McCartney
#&gt; 3 Ringo     Starr    
#&gt; 4 George    Harrison
```

---

## Negative indices exclude row / column

--


```r
beatles[-1, ] # Select all ROWS except the first
```

```
#&gt; # A tibble: 3 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 Paul      McCartney bass              1942 FALSE   
#&gt; 2 Ringo     Starr     drums             1940 FALSE   
#&gt; 3 George    Harrison  guitar            1943 TRUE
```

--


```r
beatles[,-1] # Select all COLUMNS except the first
```

```
#&gt; # A tibble: 4 × 4
#&gt;   lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 Lennon    guitar            1940 TRUE    
#&gt; 2 McCartney bass              1942 FALSE   
#&gt; 3 Starr     drums             1940 FALSE   
#&gt; 4 Harrison  guitar            1943 TRUE
```

---

# You can select columns by their names

Note: you don't need the comma to select an entire column

--

.leftcol[

One column


```r
beatles['firstName']
```

```
#&gt; # A tibble: 4 × 1
#&gt;   firstName
#&gt;   &lt;chr&gt;    
#&gt; 1 John     
#&gt; 2 Paul     
#&gt; 3 Ringo    
#&gt; 4 George
```

]

--

&lt;br&gt;Multiple columns

.rightcol[

```r
beatles[c('firstName', 'lastName')]
```

```
#&gt; # A tibble: 4 × 2
#&gt;   firstName lastName 
#&gt;   &lt;chr&gt;     &lt;chr&gt;    
#&gt; 1 John      Lennon   
#&gt; 2 Paul      McCartney
#&gt; 3 Ringo     Starr    
#&gt; 4 George    Harrison
```

]

---

## Use logical indices to _filter_ rows

--

**Which Beatles members are still alive?**&lt;br&gt;Create a logical vector using the `deceased` column:


```r
beatles$deceased == FALSE
```

```
#&gt; [1] FALSE  TRUE  TRUE FALSE
```

--

Insert this logical vector in the ROW position of `beatles[,]`:


```r
beatles[beatles$deceased == FALSE,]
```

```
#&gt; # A tibble: 2 × 5
#&gt;   firstName lastName  instrument yearOfBirth deceased
#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt; &lt;lgl&gt;   
#&gt; 1 Paul      McCartney bass              1942 FALSE   
#&gt; 2 Ringo     Starr     drums             1940 FALSE
```

---

class: inverse

<div class="countdown" id="timer_4328fdd5" data-warn-when="30" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

## Your turn

Answer these questions using the `beatles` data frame:

1. Create a new column, `playsGuitar`, which is `TRUE` if the band member plays the guitar and `FALSE` otherwise.
2. Filter the data frame to select only the rows for the band members who have four-letter first names.
3. Create a new column, `fullName`, which contains the band member's first and last name separated by a space (e.g. `"John Lennon"`)

---

class: inverse, center

# .fancy[Break]

<div class="countdown" id="timer_2b4d6988" data-warn-when="30" data-update-every="1" tabindex="0" style="top:1;right:0;bottom:0;left:0;margin:5%;font-size:8em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---



class: inverse, middle

# Week 10: .fancy[Data Frames]

### 1. Basics
### 2. Slicing

### BREAK

### 3. .orange[External data]

---

# Getting data into R

&lt;br&gt;

## Options:

## 1. Load external packages
## 2. Read in external files (usually a `.csv`* file)

&lt;br&gt;

*csv = "comma-separated values"

---

## Data from an R package


```r
library(ggplot2)
```

--

See which data frames are available in a package:


```r
data(package = "ggplot2")
```

---

# Find out about package data sets with `?`


```r
?msleep
```

```
msleep {ggplot2}

An updated and expanded version of the mammals sleep dataset

Description

This is an updated and expanded version of the mammals sleep dataset. Updated sleep times and weights were taken from V. M. Savage and G. B. West. A quantitative, theoretical framework for understanding mammalian sleep. Proceedings of the National Academy of Sciences, 104 (3):1051-1056, 2007.
```

---

# Previewing data frames: `msleep`

--

Look at the data in a "spreadsheet"-like way:


```r
View(msleep)
```

This is "read-only" so you can't corrupt the data 😄

---

# My favorite quick summary: `glimpse()`

Preview each variable with `str()` or `glimpse()`


```r
glimpse(msleep)
```

.code80[


```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ name         &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afri…
#&gt; $ genus        &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax",…
#&gt; $ vore         &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herb…
#&gt; $ order        &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha"…
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
#&gt; $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 1…
#&gt; $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.…
#&gt; $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA…
#&gt; $ awake        &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.0…
#&gt; $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, N…
#&gt; $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, …
```

]

---

## Also very useful for quick checks: `head()` and `tail()`

.leftcol[

View the **first** 6 rows with `head()`


```r
head(msleep)
```

.code80[


```
#&gt; # A tibble: 6 × 11
#&gt;   name                       genus      vore  order        conservation sleep_total sleep_rem sleep_cycle awake  brainwt  bodywt
#&gt;   &lt;chr&gt;                      &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Cheetah                    Acinonyx   carni Carnivora    lc                  12.1      NA        NA      11.9 NA        50    
#&gt; 2 Owl monkey                 Aotus      omni  Primates     &lt;NA&gt;                17         1.8      NA       7    0.0155    0.48 
#&gt; 3 Mountain beaver            Aplodontia herbi Rodentia     nt                  14.4       2.4      NA       9.6 NA         1.35 
#&gt; 4 Greater short-tailed shrew Blarina    omni  Soricomorpha lc                  14.9       2.3       0.133   9.1  0.00029   0.019
#&gt; 5 Cow                        Bos        herbi Artiodactyla domesticated         4         0.7       0.667  20    0.423   600    
#&gt; 6 Three-toed sloth           Bradypus   herbi Pilosa       &lt;NA&gt;                14.4       2.2       0.767   9.6 NA         3.85
```

]]

.rightcol[

View the **last** 6 rows with `tail()`


```r
tail(msleep)
```

.code80[


```
#&gt; # A tibble: 6 × 11
#&gt;   name                 genus    vore  order        conservation sleep_total sleep_rem sleep_cycle awake brainwt  bodywt
#&gt;   &lt;chr&gt;                &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Tenrec               Tenrec   omni  Afrosoricida &lt;NA&gt;                15.6       2.3      NA       8.4  0.0026   0.9  
#&gt; 2 Tree shrew           Tupaia   omni  Scandentia   &lt;NA&gt;                 8.9       2.6       0.233  15.1  0.0025   0.104
#&gt; 3 Bottle-nosed dolphin Tursiops carni Cetacea      &lt;NA&gt;                 5.2      NA        NA      18.8 NA      173.   
#&gt; 4 Genet                Genetta  carni Carnivora    &lt;NA&gt;                 6.3       1.3      NA      17.7  0.0175   2    
#&gt; 5 Arctic fox           Vulpes   carni Carnivora    &lt;NA&gt;                12.5      NA        NA      11.5  0.0445   3.38 
#&gt; 6 Red fox              Vulpes   carni Carnivora    &lt;NA&gt;                 9.8       2.4       0.35   14.2  0.0504   4.23
```

]]

---

# Importing an external data file

&lt;br&gt;

.leftcol60[
Note the `data.csv` file in your `data` folder.

- **DO NOT** double-click it!
- **DO NOT** open it in Excel!

Excel can **corrupt** your data!

(Don't believe me? read [this](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008984))
]

--

.rightcol40[
If you **must** open it in Excel:

- Make a copy 
- Open the copy
]

---

# Steps to importing external data files

--

## 1. Create a path to the data


```r
library(here)
*pathToData &lt;- here('data', 'data.csv')
pathToData
```

```
#&gt; [1] "/Users/jhelvy/gh/teaching/P4A/2023-Spring/class/8-data-frames/data/data.csv"
```

--

## 2. Import the data


```r
library(readr)
*df &lt;- read_csv(pathToData)
```

---

## Using the **here** package to make file paths

The `here()` function builds the path to your **root** to your _working directory_ &lt;br&gt;(this is where your `.Rproj` file lives!)


```r
here()
```

```
#&gt; [1] "/Users/jhelvy/gh/teaching/P4A/2023-Spring/class/8-data-frames"
```

--

The `here()` function builds the path to files _inside_ your working directory


```r
path_to_data &lt;- here('data', 'data.csv')
path_to_data
```

```
#&gt; [1] "/Users/jhelvy/gh/teaching/P4A/2023-Spring/class/8-data-frames/data/data.csv"
```

---

# Avoid hard-coding file paths!

### (they can break on different computers)


```r
path_to_data &lt;- 'data/data.csv'
path_to_data
```

```
#&gt; [1] "data/data.csv"
```

# 💩💩💩

---

class: center

.leftcol40[.left[

## Use the **here** package to make file paths

]]

.rightcol60[

&lt;center&gt;&lt;br&gt;
&lt;img src="images/horst_monsters_here.png"&gt;
&lt;/center&gt;Art by [Allison Horst](https://www.allisonhorst.com/)

]

---

# Use `read_csv()`, not `read.csv()`

.leftcol[

&lt;center&gt;
&lt;img src="images/read_csv.png" width=100%&gt;
&lt;/center&gt;

]

.rightcol[


```r
path_to_data &lt;- here('data', 'data.csv')
*data &lt;- read_csv(path_to_data)
```

]

---

class: inverse

<div class="countdown" id="timer_5ba55d06" data-warn-when="30" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

## Your turn

.font90[

1) Use the `here()` and `read_csv()` functions to load the `data.csv` file that is in the `data` folder. Name the data frame object `df`.

2) Use the `df` object to answer the following questions:

- How many rows and columns are in the data frame?
- Preview the different columns. What do you think this data is about? What might one row represent? What type of data is each column? (don't need to type this out...just inspect the data)
- How many unique airports are in the data frame?
- What is the earliest and latest observation in the data frame?
- What is the lowest and highest cost of any one repair in the data frame?

]

---

class: center

## Next week: better data wrangling with **dplyr**

&lt;center&gt;
&lt;img src="images/horst_monsters_data_wrangling.png" width="600"&gt;
&lt;/center&gt;Art by [Allison Horst](https://www.allisonhorst.com/)

---

# Select rows with `filter()`

Example: Filter rows to find which Beatles members are still alive?

--

**Base R**:


```r
beatles[beatles$deceased == FALSE,]
```

--

**dplyr**:


```r
filter(beatles, deceased == FALSE)
```

---

# In 2 weeks: plotting with **ggplot2**

.leftcol[

## Translate _data_...


```
#&gt; # A tibble: 11 × 2
#&gt;    brainwt   bodywt
#&gt;      &lt;dbl&gt;    &lt;dbl&gt;
#&gt;  1 0.001      0.06 
#&gt;  2 0.0066     1    
#&gt;  3 0.00014    0.005
#&gt;  4 0.0108     3.5  
#&gt;  5 0.0123     2.95 
#&gt;  6 0.0063     1.7  
#&gt;  7 4.60    2547    
#&gt;  8 0.0003     0.023
#&gt;  9 0.655    521    
#&gt; 10 0.419    187    
#&gt; 11 0.0035     0.77
```

]

.rightcol[

## ...into _information_

&lt;img src="figs/unnamed-chunk-76-1.png" width="468" /&gt;

]

---

# A note about HW 9

- You have what you need to start now.
- It will be _much_ easier if you use the **dplyr** functions (i.e. read ahead).

---

class: inverse

<div class="countdown" id="timer_29477ac1" data-warn-when="30" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">08</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

## Extra Practice!

1. Install the **dslabs** package. 
2. Load the package, then use `data(package = "dslabs")` to see the different data sets in this package. 
3. Pick one. 
4. Answer these questions:

- What is the dataset about?
- How many observations are in the data frame?
- What is the original source of the data?
- What type of data is each variable?
- Find one thing interesting about it to share.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
